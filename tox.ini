[tox]
skipsdist = True
skip_missing_interpreters = True
envlist =
  py3{6,7,8,9,10}-ao-prod
  py3{6,7,8,9,10}-nh-staging

[testenv]
setenv =
  OTEL_PYTHON_DISABLED_INSTRUMENTATIONS = urllib3
  SW_APM_DEBUG_LEVEL = 3
allowlist_externals = echo
changedir = tests
deps =
  -rdev-requirements.txt
commands_pre =
  py3{6,7,8,9,10}: pip install --upgrade pip
  py3{6,7,8,9,10}: pip install -Ie {toxinidir}
commands =
  pytest {posargs}

[testenv:py3{6,7,8,9,10}-ao-prod]
setenv =
  SW_APM_COLLECTOR = collector.appoptics.com
  SW_APM_SERVICE_KEY = <AGENT_TOKEN>:custom-distro-tox
  SW_APM_TRUSTEDPATH = {toxinidir}/tmp/solarwinds-apm/grpc-ao-prod.crt

[testenv:py3{6,7,8,9,10}-nh-staging]
setenv =
  SW_APM_COLLECTOR = apm-collector.dc-01.st-ssp.solarwinds.com
  SW_APM_SERVICE_KEY = <AGENT_TOKEN>:custom-distro-tox